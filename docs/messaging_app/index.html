<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Chat Room</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            width: 100%;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 80vh;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .main-content {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        .sidebar {
            width: 300px;
            background: #f8f9fa;
            border-right: 1px solid #e9ecef;
            padding: 20px;
            overflow-y: auto;
        }

        .chat-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: white;
        }

        .connection-section {
            background: #e3f2fd;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border: 2px solid #bbdefb;
        }

        .connection-section h3 {
            color: #1976d2;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .input-group input {
            flex: 1;
            min-width: 150px;
            padding: 10px 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 0.9rem;
            transition: border-color 0.3s ease;
        }

        .input-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .btn.secondary {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .status {
            text-align: center;
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .status.connected {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .chat-header {
            background: #f8f9fa;
            padding: 20px;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-header h3 {
            color: #333;
            font-size: 1.3rem;
        }

        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: #f8f9fa;
        }

        .message {
            margin-bottom: 15px;
            display: flex;
            flex-direction: column;
        }

        .message.sent {
            align-items: flex-end;
        }

        .message.received {
            align-items: flex-start;
        }

        .message-content {
            max-width: 70%;
            padding: 12px 16px;
            border-radius: 18px;
            word-wrap: break-word;
            position: relative;
        }

        .message.sent .message-content {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-bottom-right-radius: 4px;
        }

        .message.received .message-content {
            background: white;
            color: #333;
            border: 1px solid #e9ecef;
            border-bottom-left-radius: 4px;
        }

        .message-time {
            font-size: 0.75rem;
            opacity: 0.7;
            margin-top: 4px;
        }

        .message.sent .message-time {
            text-align: right;
        }

        .message.received .message-time {
            text-align: left;
        }

        .chat-input {
            padding: 20px;
            background: white;
            border-top: 1px solid #e9ecef;
            display: flex;
            gap: 10px;
        }

        .chat-input input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid #e9ecef;
            border-radius: 25px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .chat-input input:focus {
            outline: none;
            border-color: #667eea;
        }

        .chat-input button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .chat-input button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .chat-input button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .info-box {
            background: #e3f2fd;
            border: 1px solid #bbdefb;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
        }

        .info-box h4 {
            color: #1976d2;
            margin-bottom: 8px;
        }

        .info-box ul {
            list-style: none;
            padding-left: 0;
        }

        .info-box li {
            padding: 3px 0;
            color: #424242;
            font-size: 0.9rem;
        }

        .info-box li:before {
            content: "â€¢ ";
            color: #1976d2;
            font-weight: bold;
        }

        .empty-chat {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: #666;
            text-align: center;
        }

        .empty-chat h3 {
            margin-bottom: 10px;
            color: #333;
        }

        .empty-chat p {
            opacity: 0.7;
        }

        .user-count {
            background: #28a745;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .message-info {
            font-size: 0.8rem;
            opacity: 0.6;
            margin-bottom: 2px;
        }

        @media (max-width: 768px) {
            .container {
                height: 90vh;
            }
            
            .sidebar {
                width: 100%;
                border-right: none;
                border-bottom: 1px solid #e9ecef;
            }
            
            .main-content {
                flex-direction: column;
            }
            
            .input-group {
                flex-direction: column;
            }
            
            .input-group input {
                min-width: auto;
            }
            
            .header h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸ’¬ Simple Chat Room</h1>
            <p>Anonymous chat that auto-deletes messages for privacy</p>
        </div>

        <div class="main-content">
            <div class="sidebar">
                <div class="info-box">
                    <h4>How it works:</h4>
                    <ul>
                        <li>Enter a nickname to join</li>
                        <li>Messages auto-delete after 1 hour</li>
                        <li>No accounts or personal data required</li>
                        <li>Simple and reliable messaging</li>
                    </ul>
                </div>

                <div class="connection-section">
                    <h3>Join Chat</h3>
                    <div class="input-group">
                        <input type="text" id="nicknameInput" placeholder="Enter your nickname" maxlength="20">
                        <button class="btn" id="joinBtn">Join</button>
                    </div>
                    <div class="input-group">
                        <button class="btn secondary" id="leaveBtn" disabled>Leave Chat</button>
                    </div>
                </div>

                <div id="status" class="status" style="display: none;"></div>
            </div>

            <div class="chat-area">
                <div class="chat-header">
                    <h3 id="chatTitle">Simple Chat Room</h3>
                    <div class="user-count" id="userCount" style="display: none;">0 users</div>
                </div>

                <div class="chat-messages" id="chatMessages">
                    <div class="empty-chat">
                        <h3>Welcome to Simple Chat!</h3>
                        <p>Enter a nickname and join to start chatting.</p>
                    </div>
                </div>

                <div class="chat-input">
                    <input type="text" id="messageInput" placeholder="Type your message..." disabled maxlength="500">
                    <button id="sendBtn" disabled>Send</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        class SimpleChatApp {
            constructor() {
                this.nickname = null;
                this.isConnected = false;
                this.messages = [];
                this.users = new Set();
                this.messageTimeout = 60 * 60 * 1000; // 1 hour

                this.initializeElements();
                this.attachEventListeners();
                this.startMessageCleanup();
            }

            initializeElements() {
                this.nicknameInput = document.getElementById('nicknameInput');
                this.joinBtn = document.getElementById('joinBtn');
                this.leaveBtn = document.getElementById('leaveBtn');
                this.messageInput = document.getElementById('messageInput');
                this.sendBtn = document.getElementById('sendBtn');
                this.chatMessages = document.getElementById('chatMessages');
                this.chatTitle = document.getElementById('chatTitle');
                this.userCount = document.getElementById('userCount');
                this.statusDiv = document.getElementById('status');
            }

            attachEventListeners() {
                this.joinBtn.addEventListener('click', () => this.joinChat());
                this.leaveBtn.addEventListener('click', () => this.leaveChat());
                this.sendBtn.addEventListener('click', () => this.sendMessage());
                
                this.messageInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        this.sendMessage();
                    }
                });

                this.nicknameInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        this.joinChat();
                    }
                });
            }

            joinChat() {
                const nickname = this.nicknameInput.value.trim();
                if (!nickname) {
                    this.showStatus('Please enter a nickname', 'error');
                    return;
                }

                if (nickname.length < 2) {
                    this.showStatus('Nickname must be at least 2 characters', 'error');
                    return;
                }

                this.nickname = nickname;
                this.isConnected = true;
                this.users.add(nickname);

                this.showStatus(`Joined as ${nickname}`, 'connected');
                this.updateButtonStates(true);
                this.updateChatTitle(`Chat Room - ${nickname}`);
                this.updateUserCount();
                this.clearEmptyChat();

                // Simulate other users joining
                this.simulateUserActivity();
            }

            leaveChat() {
                if (this.nickname) {
                    this.users.delete(this.nickname);
                    this.addSystemMessage(`${this.nickname} left the chat`);
                }

                this.nickname = null;
                this.isConnected = false;
                this.messages = [];

                this.showStatus('Left chat', 'error');
                this.updateButtonStates(false);
                this.updateChatTitle('Simple Chat Room');
                this.updateUserCount();
                this.clearMessages();
                this.showEmptyChat();
            }

            sendMessage() {
                const content = this.messageInput.value.trim();
                if (!content || !this.isConnected) {
                    return;
                }

                const message = {
                    content: content,
                    nickname: this.nickname,
                    timestamp: Date.now(),
                    id: Date.now() + Math.random()
                };

                this.addMessage(message, true);
                this.messageInput.value = '';

                // Simulate receiving messages from other users
                setTimeout(() => {
                    this.simulateOtherUserMessage();
                }, Math.random() * 3000 + 1000);
            }

            simulateOtherUserMessage() {
                if (!this.isConnected) return;

                const responses = [
                    "That's interesting!",
                    "I agree with you",
                    "What do you think about that?",
                    "Thanks for sharing!",
                    "That's cool!",
                    "I see what you mean",
                    "Good point!",
                    "I hadn't thought of that",
                    "That makes sense",
                    "Interesting perspective!"
                ];

                const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                const otherNicknames = ['Alice', 'Bob', 'Charlie', 'Diana', 'Eve', 'Frank', 'Grace', 'Henry'];
                const randomNickname = otherNicknames[Math.floor(Math.random() * otherNicknames.length)];

                // Don't use the same nickname as the current user
                if (randomNickname !== this.nickname) {
                    const message = {
                        content: randomResponse,
                        nickname: randomNickname,
                        timestamp: Date.now(),
                        id: Date.now() + Math.random()
                    };

                    this.addMessage(message, false);
                }
            }

            simulateUserActivity() {
                // Simulate users joining and leaving
                setTimeout(() => {
                    if (this.isConnected) {
                        const users = ['Alice', 'Bob', 'Charlie'];
                        const randomUser = users[Math.floor(Math.random() * users.length)];
                        if (!this.users.has(randomUser)) {
                            this.users.add(randomUser);
                            this.addSystemMessage(`${randomUser} joined the chat`);
                            this.updateUserCount();
                        }
                    }
                }, Math.random() * 5000 + 2000);

                // Simulate users leaving
                setTimeout(() => {
                    if (this.isConnected && this.users.size > 1) {
                        const usersArray = Array.from(this.users).filter(u => u !== this.nickname);
                        if (usersArray.length > 0) {
                            const randomUser = usersArray[Math.floor(Math.random() * usersArray.length)];
                            this.users.delete(randomUser);
                            this.addSystemMessage(`${randomUser} left the chat`);
                            this.updateUserCount();
                        }
                    }
                }, Math.random() * 10000 + 5000);
            }

            addMessage(message, isSent) {
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${isSent ? 'sent' : 'received'}`;

                const messageInfo = document.createElement('div');
                messageInfo.className = 'message-info';
                messageInfo.textContent = isSent ? 'You' : message.nickname;

                const messageContent = document.createElement('div');
                messageContent.className = 'message-content';
                messageContent.textContent = message.content;

                const messageTime = document.createElement('div');
                messageTime.className = 'message-time';
                messageTime.textContent = new Date(message.timestamp).toLocaleTimeString();

                messageDiv.appendChild(messageInfo);
                messageDiv.appendChild(messageContent);
                messageDiv.appendChild(messageTime);

                this.chatMessages.appendChild(messageDiv);
                this.chatMessages.scrollTop = this.chatMessages.scrollHeight;

                // Store message with auto-delete timeout
                this.messages.push(message);
                setTimeout(() => {
                    this.removeMessage(message.id);
                }, this.messageTimeout);
            }

            addSystemMessage(content) {
                const messageDiv = document.createElement('div');
                messageDiv.className = 'message';
                messageDiv.style.alignItems = 'center';

                const messageContent = document.createElement('div');
                messageContent.className = 'message-content';
                messageContent.style.background = '#e3f2fd';
                messageContent.style.color = '#1976d2';
                messageContent.style.fontSize = '0.9rem';
                messageContent.style.fontStyle = 'italic';
                messageContent.textContent = content;

                messageDiv.appendChild(messageContent);
                this.chatMessages.appendChild(messageDiv);
                this.chatMessages.scrollTop = this.chatMessages.scrollHeight;
            }

            removeMessage(messageId) {
                const messageElement = this.chatMessages.querySelector(`[data-message-id="${messageId}"]`);
                if (messageElement) {
                    messageElement.remove();
                }
                this.messages = this.messages.filter(m => m.id !== messageId);
            }

            startMessageCleanup() {
                // Clean up old messages every 5 minutes
                setInterval(() => {
                    const now = Date.now();
                    this.messages = this.messages.filter(message => {
                        if (now - message.timestamp > this.messageTimeout) {
                            this.removeMessage(message.id);
                            return false;
                        }
                        return true;
                    });
                }, 5 * 60 * 1000);
            }

            clearEmptyChat() {
                const emptyChat = this.chatMessages.querySelector('.empty-chat');
                if (emptyChat) {
                    emptyChat.remove();
                }
            }

            showEmptyChat() {
                const emptyChat = document.createElement('div');
                emptyChat.className = 'empty-chat';
                emptyChat.innerHTML = `
                    <h3>Welcome to Simple Chat!</h3>
                    <p>Enter a nickname and join to start chatting.</p>
                `;
                this.chatMessages.appendChild(emptyChat);
            }

            clearMessages() {
                this.chatMessages.innerHTML = '';
            }

            updateButtonStates(inChat) {
                this.joinBtn.disabled = inChat;
                this.leaveBtn.disabled = !inChat;
                this.messageInput.disabled = !inChat;
                this.sendBtn.disabled = !inChat;
                this.nicknameInput.disabled = inChat;
            }

            updateChatTitle(title) {
                this.chatTitle.textContent = title;
            }

            updateUserCount() {
                if (this.users.size > 0) {
                    this.userCount.textContent = `${this.users.size} user${this.users.size > 1 ? 's' : ''}`;
                    this.userCount.style.display = 'block';
                } else {
                    this.userCount.style.display = 'none';
                }
            }

            showStatus(message, type) {
                this.statusDiv.textContent = message;
                this.statusDiv.className = `status ${type}`;
                this.statusDiv.style.display = 'block';

                // Auto-hide status after 3 seconds
                setTimeout(() => {
                    this.statusDiv.style.display = 'none';
                }, 3000);
            }
        }

        // Initialize the app when the page loads
        let app;
        document.addEventListener('DOMContentLoaded', () => {
            app = new SimpleChatApp();
        });
    </script>

    <!-- GA4 tracking -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-9GT4E8Z0EL"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-9GT4E8Z0EL'); 
    </script>
</body>
</html>
